

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Integration as Matrix-Vector Multiplication &mdash; SAXS 0.3.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="SAXS 0.3.0 documentation" href="index.html"/>
        <link rel="up" title="The Technology" href="TheTechnology.html"/>
        <link rel="next" title="The Geometry" href="Geometry.html"/>
        <link rel="prev" title="The Technology" href="TheTechnology.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> SAXS</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="TheTools.html">The Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="TheTools.html#the-saxsdog">The Saxsdog</a></li>
<li class="toctree-l2"><a class="reference internal" href="TheTools.html#the-converter">The Converter</a></li>
<li class="toctree-l2"><a class="reference internal" href="TheTools.html#plotchi">Plotchi</a></li>
<li class="toctree-l2"><a class="reference internal" href="TheTools.html#saxsdmerge">Saxsdmerge</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SAXSSchemaDoc.html">The Calibration File</a><ul>
<li class="toctree-l2"><a class="reference internal" href="SAXSSchemaDoc.html#calibration-file-reference">Calibration file Reference</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="TheTechnology.html">The Technology</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Integration as Matrix-Vector Multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#over-sampling">Over sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="Geometry.html">The Geometry</a></li>
<li class="toctree-l2"><a class="reference internal" href="PolCorr.html">Polarization Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fit2d.html">Compare With Fit2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="ConstantImage.html">Integrating a Constant Image With Masked Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="Statistics.html">Statistics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Server.html">The Saxsdog Network</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Server.html#the-saxsnetwork-configuration">The SAXSNetwork configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="Server.html#the-saxsdog-server">The Saxsdog Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="Server.html#the-saxs-leash">The Saxs Leash</a></li>
<li class="toctree-l2"><a class="reference internal" href="Server.html#saxs-leash-commandline">Saxs Leash Commandline</a></li>
<li class="toctree-l2"><a class="reference internal" href="Server.html#the-saxsdog-network-protocol">The Saxsdog Network Protocol</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SAXSapi.html">SAXS Module API</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SAXS</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="TheTechnology.html">The Technology</a> &raquo;</li>
      
    <li>Integration as Matrix-Vector Multiplication</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/MatrixMulti.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="integration-as-matrix-vector-multiplication">
<h1>Integration as Matrix-Vector Multiplication<a class="headerlink" href="#integration-as-matrix-vector-multiplication" title="Permalink to this headline">¶</a></h1>
<p>Every SAXS image <span class="math">\(\mathbf p\)</span> is a list of pixels that have an intensity value.
This 2d array might as well be addressed as a vector with all the pixels addressable with one index <span class="math">\(\mathbf p_i\)</span>.</p>
<p>The integration over pixels that are within a certain radial interval is
in any case a weighted sum of some of the pixels.</p>
<p>This weighted sum is a scalar product with another vector containing the weight factors.
As only the pixels in a radius interval are counted, most of these factors are 0.</p>
<div class="math">
\[r=\mathbf c \cdot \mathbf p\]</div>
<p>As we intend to do all the radial intervals at once, we write it as a matrix vector product.</p>
<div class="math">
\[\mathbf r=\mathbf X \cdot \mathbf p\]</div>
<p>The columns are the weight factors for the <span class="math">\(i^{th}\)</span> radial element.
Rearranged in the order of the image, this looks like the ring element relevant for the radial Point.</p>
<p>This matrix would be quite big as it has the dimensions len(<span class="math">\(\mathbf r\)</span>)*len(<span class="math">\(\mathbf p\)</span>). Fortunately most
of the entries are 0 and we can use a sparse matrix representation which uses only about ~len(<span class="math">\(\mathbf p\)</span>)
of memory, as every pixel is counted only once, or, as we will see, about once.</p>
<p>(<a class="reference external" href=".//MatrixMulti-1.py">Source code</a>)</p>
<div class="figure">
<img alt="_images/ringNoOv.png" src="_images/ringNoOv.png" />
<p class="caption">The vector <span class="math">\(\mathbf c\)</span> displayed as image.</p>
</div>
<p>Figure <em class="xref std std-ref">CircleNoAA</em> Shows the data of such a matrix column.</p>
</div>
<div class="section" id="over-sampling">
<h1>Over sampling<a class="headerlink" href="#over-sampling" title="Permalink to this headline">¶</a></h1>
<div class="figure" id="circle">
<img alt="_images/ring.png" src="_images/ring.png" />
<p class="caption">Ring with anti aliasing / over sampling.</p>
</div>
<p>A pixel might lie on the border of two radial intervals, making it
unclear to which one it should be added. By only choosing the nearest
one, one may get artifacts in the resulting curve especially when only few pixels contribute.
So, how could we calculate to which fraction a pixel should account to one radial interval?</p>
<p>The idea here is to use an algorithm comparable to anti aliasing in computer graphics.
We will divide a much larger picture into the radial intervals and down sample it to the real pixels.
Which results in nicely balanced factors for the border pixels that add
up nicely over joining  intervals such that the intensity is conserved. If one looks closer at image <a class="reference internal" href="#circle"><em>Ring with anti aliasing / over sampling.</em></a> ,
one sees that the ring has soft edges. Quite as it would have through anti aliasing.</p>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Geometry.html" class="btn btn-neutral float-right" title="The Geometry"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="TheTechnology.html" class="btn btn-neutral" title="The Technology"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright  2014, Tu Graz, Christian Meisenbichler, Heinz Amenitsch.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.3.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>